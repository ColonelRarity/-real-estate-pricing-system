# ü§ñ –ú–æ–¥—É–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ

## –û–≥–ª—è–¥

–ú–æ–¥—É–ª—å `ml_model.py` —Ä–µ–∞–ª—ñ–∑—É—î —Å–∏—Å—Ç–µ–º—É –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ –≤–∞—Ä—Ç–æ—Å—Ç—ñ –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ –≤ –£–∫—Ä–∞—ó–Ω—ñ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Ä—ñ–∑–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤.

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

1. **RealEstateMLModel** - –æ—Å–Ω–æ–≤–Ω–∏–π –∫–ª–∞—Å –º–æ–¥–µ–ª—ñ
2. **prepare_features()** - –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∑–Ω–∞–∫ –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è
3. **train_models()** - –Ω–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π
4. **predict_price()** - –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —Ü—ñ–Ω–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±'—î–∫—Ç–∞
5. **save_models()** / **load_models()** - –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π

### –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏

- **Linear Regression** - –ª—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è
- **Random Forest** - –≤–∏–ø–∞–¥–∫–æ–≤–∏–π –ª—ñ—Å
- **Gradient Boosting** - –≥—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ë–∞–∑–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```python
from ml_model import RealEstateMLModel

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ
model = RealEstateMLModel()

# –î–∞–Ω—ñ –¥–ª—è –æ—Ü—ñ–Ω–∫–∏
property_data = {
    'city': '–•–∞—Ä–∫—ñ–≤',
    'district': '–¶–µ–Ω—Ç—Ä',
    'area_total': 60.0,
    'rooms': 2,
    'floor': 3,
    'total_floors': 9,
    'building_type': 'brick',
    'condition': 'good',
    'heating': 'central',
    'has_balcony': True,
    'has_elevator': True
}

# –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —Ü—ñ–Ω–∏
result = model.predict_price(property_data)
print(f"–û—Ü—ñ–Ω–µ–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å: {result['predicted_price']} –≥—Ä–Ω")
print(f"–ú–æ–¥–µ–ª—å: {result['model_used']}")
```

### –ù–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π

```python
from ml_model import prepare_training_data

# –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö
df = prepare_training_data('path/to/your/data.csv')

# –ù–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π
results = model.train_models(df)
print(f"–ù–∞–π–∫—Ä–∞—â–∞ –º–æ–¥–µ–ª—å: {results['best_model']}")
```

## –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

### –û–±–æ–≤'—è–∑–∫–æ–≤—ñ
- `pandas` - –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞–Ω–∏–º–∏
- `numpy` - –¥–ª—è –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π

### –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ (–¥–ª—è –ø–æ–≤–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ)
- `scikit-learn` - –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è
- `joblib` - –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π

## –†–µ–∂–∏–º–∏ —Ä–æ–±–æ—Ç–∏

### 1. –ó sklearn (–ø–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å)

–Ø–∫—â–æ `scikit-learn` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤—Å—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ ML
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü—ñ—è —á–∏—Å–ª–æ–≤–∏—Ö –æ–∑–Ω–∞–∫
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π

### 2. –ë–µ–∑ sklearn (–±–∞–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å)

–Ø–∫—â–æ `scikit-learn` –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –ø—Ä–æ—Å—Ç–∞ —Ñ–æ—Ä–º—É–ª–∞ –æ—Ü—ñ–Ω–∫–∏
- –ë–∞–∑–æ–≤—ñ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó
- –û–±–º–µ–∂–µ–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, –∞–ª–µ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∞—Ü—é—î

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

–î–ª—è –ø–æ–≤–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ ML –º–æ–¥–µ–ª–µ–π –∑–∞–ø—É—Å—Ç—ñ—Ç—å:

```bash
cd backend
python install_ml_dependencies.py
```

–ê–±–æ –≤—Ä—É—á–Ω—É:

```bash
pip install scikit-learn pandas numpy joblib
```

## –û–∑–Ω–∞–∫–∏ –º–æ–¥–µ–ª—ñ

### –í—Ö—ñ–¥–Ω—ñ –æ–∑–Ω–∞–∫–∏
- `area_total` - –∑–∞–≥–∞–ª—å–Ω–∞ –ø–ª–æ—â–∞ (–º¬≤)
- `rooms` - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫—ñ–º–Ω–∞—Ç
- `floor` - –ø–æ–≤–µ—Ä—Ö
- `total_floors` - –∑–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–≤–µ—Ä—Ö—ñ–≤
- `year_built` - —Ä—ñ–∫ –ø–æ–±—É–¥–æ–≤–∏
- `city` - –º—ñ—Å—Ç–æ
- `district` - —Ä–∞–π–æ–Ω
- `building_type` - —Ç–∏–ø –±—É–¥–∏–Ω–∫—É
- `condition` - —Å—Ç–∞–Ω –∫–≤–∞—Ä—Ç–∏—Ä–∏
- `heating` - —Ç–∏–ø –æ–ø–∞–ª–µ–Ω–Ω—è
- `has_balcony` - –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –±–∞–ª–∫–æ–Ω—É
- `has_elevator` - –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ª—ñ—Ñ—Ç—É

### –°—Ç–≤–æ—Ä–µ–Ω—ñ –æ–∑–Ω–∞–∫–∏
- `price_per_sqm` - —Ü—ñ–Ω–∞ –∑–∞ –º¬≤
- `room_density` - —â—ñ–ª—å–Ω—ñ—Å—Ç—å –∫—ñ–º–Ω–∞—Ç
- `floor_ratio` - —Å–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è –ø–æ–≤–µ—Ä—Ö—É
- `is_first_floor` - —á–∏ –ø–µ—Ä—à–∏–π –ø–æ–≤–µ—Ä—Ö
- `is_last_floor` - —á–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π –ø–æ–≤–µ—Ä—Ö

## –ü—Ä–æ—Å—Ç–∞ —Ñ–æ—Ä–º—É–ª–∞ –æ—Ü—ñ–Ω–∫–∏

–Ø–∫—â–æ ML –º–æ–¥–µ–ª—ñ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø—Ä–æ—Å—Ç–∞ —Ñ–æ—Ä–º—É–ª–∞:

```
—Ü—ñ–Ω–∞ = –ø–ª–æ—â–∞ √ó –±–∞–∑–æ–≤–∞_—Ü—ñ–Ω–∞_–∑–∞_–º¬≤ √ó –º–Ω–æ–∂–Ω–∏–∫_—Å—Ç–∞–Ω—É √ó –º–Ω–æ–∂–Ω–∏–∫_—Ç–∏–ø—É_–±—É–¥–∏–Ω–∫—É
```

### –ë–∞–∑–æ–≤—ñ —Ü—ñ–Ω–∏ –∑–∞ –º—ñ—Å—Ç–∞–º–∏ (–∑–∞ –º¬≤)
- –ö–∏—ó–≤: 2500 –≥—Ä–Ω
- –•–∞—Ä–∫—ñ–≤: 1200 –≥—Ä–Ω
- –õ—å–≤—ñ–≤: 1800 –≥—Ä–Ω
- –û–¥–µ—Å–∞: 1600 –≥—Ä–Ω
- –î–Ω—ñ–ø—Ä–æ: 1400 –≥—Ä–Ω

### –ú–Ω–æ–∂–Ω–∏–∫–∏ —Å—Ç–∞–Ω—É
- –í—ñ–¥–º—ñ–Ω–Ω–∏–π: 1.3
- –î–æ–±—Ä–∏–π: 1.1
- –ó–∞–¥–æ–≤—ñ–ª—å–Ω–∏–π: 1.0
- –ü–æ–≥–∞–Ω–∏–π: 0.8

### –ú–Ω–æ–∂–Ω–∏–∫–∏ —Ç–∏–ø—É –±—É–¥–∏–Ω–∫—É
- –¶–µ–≥–ª—è–Ω–∏–π: 1.2
- –ú–æ–Ω–æ–ª—ñ—Ç–Ω–∏–π: 1.1
- –ü–∞–Ω–µ–ª—å–Ω–∏–π: 1.0
- –î–µ—Ä–µ–≤'—è–Ω–∏–π: 0.9

## –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

–ú–æ–¥–µ–ª—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó `models/` —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É —Å–µ—Ä–≤–µ—Ä–∞.

## –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ API

```python
# –£ main.py
ml_model = RealEstateMLModel()

# –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –≤ –µ–Ω–¥–ø–æ—ñ–Ω—Ç—ñ
@app.get("/properties/{property_id}/valuation")
async def get_valuation(property_id: str):
    # ... –∫–æ–¥ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö ...

    # –û—Ü—ñ–Ω–∫–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ML –º–æ–¥–µ–ª—ñ
    ml_prediction = ml_model.predict_price(property_data)

    if 'predicted_price' in ml_prediction:
        estimated_value = int(ml_prediction['predicted_price'])
        confidence = ml_prediction.get('confidence', 0.7)
        model_used = ml_prediction.get('model_used', 'ml')
    else:
        # Fallback –Ω–∞ –ø—Ä–æ—Å—Ç—É –æ—Ü—ñ–Ω–∫—É
        estimated_value = int(72000)  # 60–º¬≤ * 1200 –≥—Ä–Ω/–º¬≤
        confidence = 0.6
        model_used = 'simple'

    # ... —Ä–µ—à—Ç–∞ –∫–æ–¥—É ...
```

## –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è

–ú–æ–¥—É–ª—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è Python. –í—Å—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ –º–æ–¥–µ–ª—è–º–∏ –ª–æ–≥—É—é—Ç—å—Å—è –∑ —Ä—ñ–≤–Ω–µ–º INFO —Ç–∞ ERROR.

## –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è

–î–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤:

1. –î–æ–¥–∞–π—Ç–µ —ñ–º–ø–æ—Ä—Ç –≤ –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω—É —Å–µ–∫—Ü—ñ—é
2. –î–æ–¥–∞–π—Ç–µ –º–æ–¥–µ–ª—å –≤ —Å–ª–æ–≤–Ω–∏–∫ `models` –≤ –º–µ—Ç–æ–¥—ñ `train_models()`
3. –î–æ–¥–∞–π—Ç–µ –ª–æ–≥—ñ–∫—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ `load_models()`
