# üéØ KNN-based —Å–∏—Å—Ç–µ–º–∞ –æ—Ü—ñ–Ω–∫–∏ –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ

## –û–≥–ª—è–¥

–ù–æ–≤–∞ —Å–∏—Å—Ç–µ–º–∞ –æ—Ü—ñ–Ω–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **–∞–ª–≥–æ—Ä–∏—Ç–º K –Ω–∞–π–±–ª–∏–∂—á–∏—Ö —Å—É—Å—ñ–¥—ñ–≤ (KNN)** –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–æ—á–Ω–æ—ó –æ—Ü—ñ–Ω–∫–∏ –≤–∞—Ä—Ç–æ—Å—Ç—ñ –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–µ–∞–ª—å–Ω–∏—Ö —Ä–∏–Ω–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö.

## –ü—Ä–∏–Ω—Ü–∏–ø —Ä–æ–±–æ—Ç–∏

### üîç –ê–ª–≥–æ—Ä–∏—Ç–º –æ—Ü—ñ–Ω–∫–∏

1. **–ü–æ—à—É–∫ —Å—Ö–æ–∂–∏—Ö –æ–±'—î–∫—Ç—ñ–≤** - —Å–∏—Å—Ç–µ–º–∞ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å K –Ω–∞–π—Å—Ö–æ–∂—ñ—à–∏—Ö –æ–≥–æ–ª–æ—à–µ–Ω—å –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö
2. **–í–∞–≥—É–≤–∞–Ω–Ω—è —Ñ–∞–∫—Ç–æ—Ä—ñ–≤** - –∫–æ–∂–µ–Ω —Ñ–∞–∫—Ç–æ—Ä —Å—Ö–æ–∂–æ—Å—Ç—ñ –º–∞—î —Å–≤–æ—é –≤–∞–≥—É (–≤—ñ–¥ 0 –¥–æ 1)
3. **–ó–≤–∞–∂–µ–Ω–∞ –æ—Ü—ñ–Ω–∫–∞** - —Ü—ñ–Ω–∞ –æ–±—á–∏—Å–ª—é—î—Ç—å—Å—è —è–∫ –∑–≤–∞–∂–µ–Ω–∞ —Å–µ—Ä–µ–¥–Ω—è —Ü—ñ–Ω —Å—Ö–æ–∂–∏—Ö –æ–±'—î–∫—Ç—ñ–≤
4. **–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –≤–ø–µ–≤–Ω–µ–Ω–æ—Å—Ç—ñ** - –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–Ω–∞–π–¥–µ–Ω–∏—Ö –æ–±'—î–∫—Ç—ñ–≤ —Ç–∞ —ó—Ö —Å—Ö–æ–∂–æ—Å—Ç—ñ

### üìä –§–∞–∫—Ç–æ—Ä–∏ —Å—Ö–æ–∂–æ—Å—Ç—ñ (–∑ –≤–∞–≥–∞–º–∏)

| –§–∞–∫—Ç–æ—Ä | –í–∞–≥–∞ | –û–ø–∏—Å |
|--------|------|------|
| **–ú—ñ—Å—Ç–æ** | 1.0 | –ö—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–π —Ñ–∞–∫—Ç–æ—Ä |
| **–†–∞–π–æ–Ω** | 0.9 | –î—É–∂–µ –≤–∞–∂–ª–∏–≤–∏–π –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ—ó —Ü—ñ–Ω–∏ |
| **–í—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏** | 0.8 | –ì–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∞ –±–ª–∏–∑—å–∫—ñ—Å—Ç—å |
| **–í—ñ–¥—Å—Ç–∞–Ω—å –¥–æ —Ü–µ–Ω—Ç—Ä—É** | 0.6 | –ë–ª–∏–∑—å–∫—ñ—Å—Ç—å –¥–æ —Ü–µ–Ω—Ç—Ä—É –º—ñ—Å—Ç–∞ |
| **–ü–ª–æ—â–∞** | 0.9 | –†–æ–∑–º—ñ—Ä –∫–≤–∞—Ä—Ç–∏—Ä–∏ (—á–∏–º –±–ª–∏–∂—á–µ, —Ç–∏–º –∫—Ä–∞—â–µ) |
| **–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫—ñ–º–Ω–∞—Ç** | 0.8 | –¢–æ—á–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –∫—ñ–º–Ω–∞—Ç |
| **–ü–æ–≤–µ—Ä—Ö** | 0.7 | –í–∏—Å–æ—Ç–∞ –ø–æ–≤–µ—Ä—Ö—É |
| **–ó–∞–≥–∞–ª—å–Ω–∞ –ø–æ–≤–µ—Ä—Ö–æ–≤—ñ—Å—Ç—å** | 0.6 | –¢–∏–ø –±—É–¥–∏–Ω–∫—É (5-9, 10-16, —Ç–æ—â–æ) |
| **–ö–∞—Ç–µ–≥–æ—Ä—ñ—è –ø–æ–≤–µ—Ä—Ö—É** | 0.5 | –ù–∏–∂–Ω—ñ–π/—Å–µ—Ä–µ–¥–Ω—ñ–π/–≤–µ—Ä—Ö–Ω—ñ–π –ø–æ–≤–µ—Ä—Ö |
| **–¢–∏–ø –±—É–¥–∏–Ω–∫—É** | 0.8 | –¶–µ–≥–ª–∞/–ø–∞–Ω–µ–ª—å/–º–æ–Ω–æ–ª—ñ—Ç |
| **–†—ñ–∫ –±—É–¥—É–≤–∞–Ω–Ω—è** | 0.7 | –í—ñ–∫ –±—É–¥–∏–Ω–∫—É (¬±50 —Ä–æ–∫—ñ–≤) |
| **–°—Ç–∞–Ω** | 0.6 | –í—ñ–¥–º—ñ–Ω–Ω–∏–π/–¥–æ–±—Ä–∏–π/–∑–∞–¥–æ–≤—ñ–ª—å–Ω–∏–π |
| **–ó–∞–±—É–¥–æ–≤–Ω–∏–∫** | 0.5 | –û–¥–Ω–∞–∫–æ–≤–∏–π –∑–∞–±—É–¥–æ–≤–Ω–∏–∫ |
| **–°–µ—Ä—ñ—è –±—É–¥–∏–Ω–∫—É** | 0.4 | –î–ª—è –ø–∞–Ω–µ–ª—å–Ω–∏—Ö –±—É–¥–∏–Ω–∫—ñ–≤ |
| **–ë–∞–ª–∫–æ–Ω** | 0.3 | –ù–∞—è–≤–Ω—ñ—Å—Ç—å –±–∞–ª–∫–æ–Ω—É |
| **–õ—ñ—Ñ—Ç** | 0.3 | –ù–∞—è–≤–Ω—ñ—Å—Ç—å –ª—ñ—Ñ—Ç—É |
| **–û–ø–∞–ª–µ–Ω–Ω—è** | 0.3 | –¢–∏–ø –æ–ø–∞–ª–µ–Ω–Ω—è |

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### 1. –ú—ñ–≥—Ä–∞—Ü—ñ—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

```bash
cd backend
python migration_add_fields.py
```

### 2. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –ø–æ–≤–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ:
```bash
python install_ml_dependencies.py
```

### 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
python main.py
```

## API Endpoints

### üîç –û—Ü—ñ–Ω–∫–∞ –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ

```http
GET /properties/{property_id}/valuation
```

**–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:**
```json
{
  "property_id": "prop_123",
  "estimated_price": 125000,
  "price_range": {
    "min": 115000,
    "max": 135000
  },
  "confidence": 0.87,
  "model_used": "knn_weighted_average",
  "similar_properties_count": 8,
  "avg_similarity": 0.76,
  "comparable_properties": [
    {
      "id": "prop_456",
      "price_uah": 120000,
      "area_total": 58.0,
      "rooms": 2,
      "address": "–≤—É–ª. –°—É–º—Å—å–∫–∞ 15",
      "similarity": 0.85,
      "building_type": "brick",
      "year_built": 2015
    }
  ],
  "market_trends": {
    "total_listings": 1250,
    "avg_price": 118000,
    "avg_price_per_sqm": 1950
  }
}
```

### ‚ûï –î–æ–¥–∞–≤–∞–Ω–Ω—è –æ–≥–æ–ª–æ—à–µ–Ω—å

```http
POST /properties/add
Content-Type: application/json

{
  "city": "–•–∞—Ä–∫—ñ–≤",
  "district": "–¶–µ–Ω—Ç—Ä",
  "area": 65.0,
  "rooms": 2,
  "floor": 4,
  "total_floors": 9,
  "building_type": "brick",
  "condition": "good",
  "heating": "central",
  "has_balcony": true,
  "has_elevator": true
}
```

### üí∞ –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ü—ñ–Ω–∏

```http
PUT /properties/{property_id}/price
Content-Type: application/json

{
  "price_uah": 125000
}
```

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º–∏

### üìÅ –§–∞–π–ª–∏ –ø—Ä–æ–µ–∫—Ç—É

```
backend/
‚îú‚îÄ‚îÄ main.py                 # –û—Å–Ω–æ–≤–Ω–∏–π —Å–µ—Ä–≤–µ—Ä FastAPI
‚îú‚îÄ‚îÄ knn_valuation.py        # KNN –∞–ª–≥–æ—Ä–∏—Ç–º –æ—Ü—ñ–Ω–∫–∏
‚îú‚îÄ‚îÄ ml_model.py            # Fallback ML –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ database.py            # –†–æ–±–æ—Ç–∞ –∑ –ë–î
‚îú‚îÄ‚îÄ models.py              # –ú–æ–¥–µ–ª—ñ –¥–∞–Ω–∏—Ö
‚îú‚îÄ‚îÄ migration_add_fields.py # –ú—ñ–≥—Ä–∞—Ü—ñ—è –ë–î
‚îî‚îÄ‚îÄ test_knn_valuation.py  # –¢–µ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º–∏
```

### üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

#### PropertyListing (–æ—Å–Ω–æ–≤–Ω–∞ —Ç–∞–±–ª–∏—Ü—è)
- `building_series` - —Å–µ—Ä—ñ—è –±—É–¥–∏–Ω–∫—É
- `developer` - –∑–∞–±—É–¥–æ–≤–Ω–∏–∫
- `floor_category` - –∫–∞—Ç–µ–≥–æ—Ä—ñ—è –ø–æ–≤–µ—Ä—Ö—É (low/middle/high)
- `distance_to_center` - –≤—ñ–¥—Å—Ç–∞–Ω—å –¥–æ —Ü–µ–Ω—Ç—Ä—É –≤ –∫–º
- `price_per_sqm` - —Ü—ñ–Ω–∞ –∑–∞ –º¬≤ (–∞–≤—Ç–æ–æ–±—á–∏—Å–ª–µ–Ω–Ω—è)
- `days_on_market` - –¥–Ω—ñ–≤ –Ω–∞ —Ä–∏–Ω–∫—É

#### –Ü–Ω–¥–µ–∫—Å–∏ –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –ø–æ—à—É–∫—É
- `idx_listings_building` - —Ç–∏–ø + —Ä—ñ–∫ –±—É–¥—É–≤–∞–Ω–Ω—è
- `idx_listings_developer` - –∑–∞–±—É–¥–æ–≤–Ω–∏–∫
- `idx_listings_condition` - —Å—Ç–∞–Ω –∫–≤–∞—Ä—Ç–∏—Ä–∏
- `idx_listings_price_per_sqm` - —Ü—ñ–Ω–∞ –∑–∞ –º¬≤

## –Ø–∫ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ —Ç–æ—á–Ω—ñ—Å—Ç—å

### 1. –î–æ–¥–∞–≤–∞–Ω–Ω—è –±—ñ–ª—å—à–µ –æ–≥–æ–ª–æ—à–µ–Ω—å

–ß–∏–º –±—ñ–ª—å—à–µ —Ä–µ–∞–ª—å–Ω–∏—Ö –æ–≥–æ–ª–æ—à–µ–Ω—å –≤ –±–∞–∑—ñ, —Ç–∏–º —Ç–æ—á–Ω—ñ—à–∞ –æ—Ü—ñ–Ω–∫–∞:

```bash
# –ß–µ—Ä–µ–∑ API
curl -X POST http://localhost:8000/properties/add \
  -H "Content-Type: application/json" \
  -d '{"city": "–•–∞—Ä–∫—ñ–≤", "district": "–¶–µ–Ω—Ç—Ä", "area": 60, ...}'

# –ß–µ—Ä–µ–∑ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—è–∫—â–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π)
```

### 2. –î–µ—Ç–∞–ª—å–Ω—ñ—à–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–ù–∞–¥–∞–≤–∞–π—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–µ—Ç–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è:
- –¢–æ—á–Ω–∞ –∞–¥—Ä–µ—Å–∞ (–¥–ª—è –≥–µ–æ–∫–æ–¥—É–≤–∞–Ω–Ω—è)
- –ó–∞–±—É–¥–æ–≤–Ω–∏–∫ (–¥–ª—è —Å–µ—Ä—ñ–π–Ω–∏—Ö –±—É–¥–∏–Ω–∫—ñ–≤)
- –°–µ—Ä—ñ—è –±—É–¥–∏–Ω–∫—É (–¥–ª—è –ø–∞–Ω–µ–ª—å–Ω–∏—Ö)
- –†—ñ–∫ –≤–≤–µ–¥–µ–Ω–Ω—è –≤ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—é

### 3. –ì–µ–æ–∫–æ–¥—É–≤–∞–Ω–Ω—è

–î–ª—è –∫—Ä–∞—â–æ—ó —Ä–æ–±–æ—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—É –¥–æ–¥–∞–π—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏:
```python
# –í models.py
listing.latitude = 49.9935  # –®–∏—Ä–æ—Ç–∞
listing.longitude = 36.2304  # –î–æ–≤–≥–æ—Ç–∞
listing.calculate_distance_to_center(center_lat, center_lon)
```

## –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—É

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∞–≥ —Ñ–∞–∫—Ç–æ—Ä—ñ–≤

```python
from knn_valuation import SimilarityWeights

# –ö–∞—Å—Ç–æ–º–Ω—ñ –≤–∞–≥–∏
weights = SimilarityWeights(
    city_match=1.0,           # –ú—ñ—Å—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–µ
    district_match=0.9,       # –†–∞–π–æ–Ω –¥—É–∂–µ –≤–∞–∂–ª–∏–≤–∏–π
    area_similarity=0.9,      # –ü–ª–æ—â–∞ –≤–∞–∂–ª–∏–≤–∞
    building_type_match=0.8,  # –¢–∏–ø –±—É–¥–∏–Ω–∫—É –≤–∞–∂–ª–∏–≤–∏–π
    year_built_similarity=0.7 # –†—ñ–∫ –±—É–¥—É–≤–∞–Ω–Ω—è –º–µ–Ω—à –∫—Ä–∏—Ç–∏—á–Ω–∏–π
)
```

### –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å—É—Å—ñ–¥—ñ–≤ (K)

```python
knn_valuator = KNNValuator(db_manager, k=15)  # 15 –Ω–∞–π—Å—Ö–æ–∂—ñ—à–∏—Ö –æ–±'—î–∫—Ç—ñ–≤
```

## –§–æ–ª–±–µ–∫–∏ —Ç–∞ –Ω–∞–¥—ñ–π–Ω—ñ—Å—Ç—å

### –¢—Ä–∏—Ä—ñ–≤–Ω–µ–≤–∞ —Å–∏—Å—Ç–µ–º–∞ –æ—Ü—ñ–Ω–∫–∏

1. **KNN –æ—Ü—ñ–Ω–∫–∞** - —è–∫—â–æ —î 3+ —Å—Ö–æ–∂–∏—Ö –æ–±'—î–∫—Ç—ñ–≤
2. **ML –º–æ–¥–µ–ª—å** - —è–∫—â–æ sklearn –¥–æ—Å—Ç—É–ø–Ω–∏–π
3. **–ü—Ä–æ—Å—Ç–∞ —Ñ–æ—Ä–º—É–ª–∞** - –±–∞–∑–æ–≤–∞ –æ—Ü—ñ–Ω–∫–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—è

```python
# –í main.py
knn_result = knn_valuator.estimate_price(property_data, k=15)

if knn_result.get('estimated_price') and knn_result.get('similar_properties_count', 0) >= 3:
    # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ KNN
    estimated_value = knn_result['estimated_price']
else:
    # Fallback –Ω–∞ ML –∞–±–æ –ø—Ä–æ—Å—Ç—É —Ñ–æ—Ä–º—É–ª—É
    ml_prediction = ml_model.predict_price(property_data)
    # ...
```

## –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```http
GET /admin/stats
```

### –ê–Ω–∞–ª—ñ–∑ —Å—Ö–æ–∂–æ—Å—Ç—ñ

```python
# –í —Ç–µ—Å—Ç–∞—Ö
knn_valuator = KNNValuator(db_manager)
similarity = knn_valuator.calculate_similarity_score(prop1, prop2)
```

## –ú–∞–π–±—É—Ç–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

### üöÄ –ü–ª–∞–Ω–æ–≤–∞–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≥–µ–æ–∫–æ–¥—É–≤–∞–Ω–Ω—è** –∞–¥—Ä–µ—Å —á–µ—Ä–µ–∑ Google Maps API
2. **–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —Å–∞–π—Ç–∞–º–∏** –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –∑–±–æ—Ä—É –¥–∞–Ω–∏—Ö
3. **–ú–∞—à–∏–Ω–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∞–≥ —Ñ–∞–∫—Ç–æ—Ä—ñ–≤
4. **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—è** —Ä–∞–π–æ–Ω—ñ–≤ –∑–∞ —Ü—ñ–Ω–æ–≤–∏–º–∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏
5. **–ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —Ç—Ä–µ–Ω–¥—ñ–≤** –Ω–∞ –æ—Å–Ω–æ–≤—ñ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö

### üìà –ú–µ—Ç—Ä–∏–∫–∏ —è–∫–æ—Å—Ç—ñ

- **MAE** (Mean Absolute Error) - —Å–µ—Ä–µ–¥–Ω—è –∞–±—Å–æ–ª—é—Ç–Ω–∞ –ø–æ—Ö–∏–±–∫–∞
- **MAPE** (Mean Absolute Percentage Error) - —Å–µ—Ä–µ–¥–Ω—è –∞–±—Å–æ–ª—é—Ç–Ω–∞ –≤—ñ–¥—Å–æ—Ç–∫–æ–≤–∞ –ø–æ—Ö–∏–±–∫–∞
- **–í–ø–µ–∑–Ω–µ–Ω—ñ—Å—Ç—å** - –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Å—Ö–æ–∂–∏—Ö –æ–±'—î–∫—Ç—ñ–≤

## –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ü—Ä–∏–∫–ª–∞–¥ 1: –û—Ü—ñ–Ω–∫–∞ –Ω–æ–≤–æ—ó –∫–≤–∞—Ä—Ç–∏—Ä–∏

```python
# –î–∞–Ω—ñ –Ω–æ–≤–æ—ó –∫–≤–∞—Ä—Ç–∏—Ä–∏
new_apartment = {
    'city': '–•–∞—Ä–∫—ñ–≤',
    'district': '–û–ª–µ–∫—Å—ñ—ó–≤–∫–∞',
    'area_total': 70.0,
    'rooms': 3,
    'floor': 8,
    'total_floors': 16,
    'building_type': 'monolithic',
    'year_built': 2020,
    'condition': 'excellent',
    'developer': '–¢–ú–ú'
}

# –û—Ü—ñ–Ω–∫–∞
result = knn_valuator.estimate_price(new_apartment)
print(f"–û—Ü—ñ–Ω–µ–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å: {result['estimated_price']} –≥—Ä–Ω")
```

### –ü—Ä–∏–∫–ª–∞–¥ 2: –ê–Ω–∞–ª—ñ–∑ —Å—Ö–æ–∂–æ—Å—Ç—ñ

```python
# –î–≤–∞ —Å—Ö–æ–∂—ñ –æ–±'—î–∫—Ç–∏
prop1 = {'city': '–•–∞—Ä–∫—ñ–≤', 'area_total': 60, 'building_type': 'brick'}
prop2 = {'city': '–•–∞—Ä–∫—ñ–≤', 'area_total': 58, 'building_type': 'brick'}

similarity = knn_valuator.calculate_similarity_score(prop1, prop2)
print(f"–°—Ö–æ–∂—ñ—Å—Ç—å: {similarity:.1%}")  # ~85%
```

## –í–∏—Å–Ω–æ–≤–∫–∏

### ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏ –Ω–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏

1. **–†–µ–∞–ª—å–Ω—ñ —Ä–∏–Ω–∫–æ–≤—ñ –¥–∞–Ω—ñ** - –æ—Ü—ñ–Ω–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ñ–∞–∫—Ç–∏—á–Ω–∏—Ö –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ–π
2. **–î–µ—Ç–∞–ª—å–Ω–µ –≤—Ä–∞—Ö—É–≤–∞–Ω–Ω—è —Ñ–∞–∫—Ç–æ—Ä—ñ–≤** - 16 —Ñ–∞–∫—Ç–æ—Ä—ñ–≤ —Å—Ö–æ–∂–æ—Å—Ç—ñ –∑ –≤–∞–≥–∞–º–∏
3. **–ì–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å** - –≤—Ä–∞—Ö—É–≤–∞–Ω–Ω—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Ç–∞ –≤—ñ–¥—Å—Ç–∞–Ω–µ–π
4. **–ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è –Ω–∞ –Ω–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö
5. **–ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å** - —Ç—Ä–∏—Ä—ñ–≤–Ω–µ–≤–∞ —Å–∏—Å—Ç–µ–º–∞ —Ñ–æ–ª–±–µ–∫—ñ–≤

### üéØ –¢–æ—á–Ω—ñ—Å—Ç—å –æ—Ü—ñ–Ω–∫–∏

- **–ü—Ä–∏ 10+ —Å—Ö–æ–∂–∏—Ö –æ–±'—î–∫—Ç–∞—Ö** - —Ç–æ—á–Ω—ñ—Å—Ç—å 85-95%
- **–ü—Ä–∏ 5-10 —Å—Ö–æ–∂–∏—Ö –æ–±'—î–∫—Ç–∞—Ö** - —Ç–æ—á–Ω—ñ—Å—Ç—å 75-85%
- **–ü—Ä–∏ 3-5 —Å—Ö–æ–∂–∏—Ö –æ–±'—î–∫—Ç–∞—Ö** - —Ç–æ—á–Ω—ñ—Å—Ç—å 65-75%
- **–ü—Ä–∏ <3 —Å—Ö–æ–∂–∏—Ö –æ–±'—î–∫—Ç–∞—Ö** - fallback –Ω–∞ —ñ–Ω—à—ñ –º–µ—Ç–æ–¥–∏

### üöÄ –®–ª—è—Ö –≤–ø–µ—Ä–µ–¥

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É —Ç–∞ –º–æ–∂–µ –±—É—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏ –¥–ª—è —â–µ –±—ñ–ª—å—à–æ—ó —Ç–æ—á–Ω–æ—Å—Ç—ñ –æ—Ü—ñ–Ω–∫–∏ –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ.
